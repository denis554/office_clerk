%table.table.table-striped.table-bordered.table-condensed
  %thead
    %tr
      %th= t(:name)
      %th= t(:quantity)
      %th= t(:price)
      %th= t(:total)
  %tbody
    %tr{:class => "line-#{cycle("1","2")}" ,"v-for" => "item in basket.items"}
      %td
        %a{ ":href" => "'/products/' + item.product_id"}
          {{item.name}}
      %td.quantity
        {{item.quantity}}
        .overlay
          %a{ "@click" => "item.quantity += 1; changed = true"}
            =image_tag "plus.png"
          %span {{item.quantity}}
          %a{ "@click" => "item.quantity -= 1; changed = true"}
            =image_tag "minus.png"
      %td {{item.price}}
      %td {{(item.price * item.quantity).toFixed(2)}}
    %tr
      %th= t(:total)
      %td {{total_amount()}}
      %td
        = form_for(@purchase.basket) do |f|
          %span{"v-for" => "(item , index) in this.basket.items"}
            %input{hidden: true , "v-bind" => "itemProp(item,index,'id')" , "v-if"=> "item.id"}/
            %input{hidden: true , "v-bind" => "itemProp(item,index,'name')"}/
            %input{hidden: true , "v-bind" => "itemProp(item,index,'price')"}/
            %input{hidden: true , "v-bind" => "itemProp(item,index,'quantity')"}/
            %input{hidden: true , "v-bind" => "itemProp(item,index,'product_id')"}/
          = f.submit :class => "btn btn-success commit" ,"v-if" => "changed", "@click" => "submit_basket"
      %th
        {{total_price().toFixed(2)}}
